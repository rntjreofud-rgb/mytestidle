/* =================================================================
   1. 기본 설정 및 변수 (Root & Reset)
   ================================================================= */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Consolas&display=swap');

:root {
    --bg-main: #1a1a2e;       --bg-sidebar: #11111f;    --bg-panel: #16213e;      
    --bg-button: #0f3460;     --bg-button-hover: #1f4287; --bg-button-disabled: #0a1120;
    --border-color: #2a2a40;  --primary-orange: #e94560; --accent-green: #4ecca3;
    --accent-blue: #4db5ff;   --text-main: #e0e0e0;     --text-muted: #8892b0;
}

* { box-sizing: border-box; }
body {
    font-family: 'Noto Sans KR', sans-serif;
    background-color: var(--bg-main); color: var(--text-main);
    margin: 0; padding: 0; width: 100vw; height: 100vh;
    display: flex; overflow: hidden; font-size: 13px;
}

/* =================================================================
   2. 사이드바 및 네비게이션 (Sidebar)
   ================================================================= */
.sidebar {
    width: 200px; height: 100%; background-color: var(--bg-sidebar);
    border-right: 1px solid #000; display: flex; flex-direction: column; flex-shrink: 0;
}
.logo-area { padding: 20px 10px; background-color: #0b0b14; text-align: center; }
.logo-area h1 { margin: 0; font-size: 1.1rem; color: var(--accent-green); letter-spacing: 1px; }
.nav-menu { flex: 1; overflow-y: auto; padding: 10px 0; }
.nav-category { font-size: 0.75rem; color: #556; margin: 15px 0 5px 15px; font-weight: bold; }
.nav-item { 
    display: flex; align-items: center; padding: 10px 15px; cursor: pointer; 
    color: var(--text-muted); font-size: 0.9rem; transition: 0.2s; 
}
.nav-item:hover, .nav-item.active { 
    background-color: var(--bg-panel); color: #fff; border-left: 3px solid var(--primary-orange); 
}
.nav-item i { margin-right: 10px; width: 16px; text-align: center; }

/* =================================================================
   3. 메인 레이아웃 (Main Content)
   ================================================================= */
.main-wrapper { flex: 1; display: flex; flex-direction: column; height: 100%; overflow: hidden; }
header { 
    background-color: var(--bg-panel); border-bottom: 1px solid var(--border-color); 
    padding: 0 20px; display: flex; justify-content: space-between; align-items: center; 
    flex-shrink: 0; height: 50px; 
}
.content-area { flex: 1; overflow-y: auto; padding: 20px; background-color: var(--bg-main); }

/* 상단 정보 패널 */
.info-panel { 
    background-color: var(--bg-panel); border-left: 4px solid var(--accent-blue); 
    padding: 15px; margin-bottom: 20px; display: flex; align-items: center; 
    justify-content: space-between; border-radius: 8px; 
}
.section-title { font-size: 0.9rem; color: #8892b0; margin-bottom: 10px; font-weight: bold; }

/* 액션 그리드 (수동 25% : 자동 75%) */
.action-grid {
    display: grid; grid-template-columns: 280px 1fr; gap: 20px; width: 100%; margin-bottom: 20px;
}

/* =================================================================
   4. 자원 카드 및 창고 (Resource Cards)
   ================================================================= */
.sub-res-grid {
    display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); 
    gap: 10px; margin-bottom: 20px; width: 100%;
}
.res-card {
    background-color: var(--bg-panel); padding: 10px 15px; border-radius: 8px;
    min-height: 80px; display: flex; flex-direction: column; justify-content: space-between;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2); position: relative;
}
.res-card::after { 
    content: ''; display: block; height: 3px; width: 100%; margin-top: 8px; 
    border-radius: 2px; flex-shrink: 0; 
}
.res-amount { font-size: 1.3rem; font-weight: 700; color: #fff; margin: 0; }
.res-mps { font-size: 0.8rem; color: var(--text-muted); }

/* 자원별 색상 바 */
.res-card.wood::after { background-color: #27ae60; }
.res-card.stone::after { background-color: #7f8c8d; }
.res-card.coal::after { background-color: #2c3e50; }
.res-card.ironOre::after { background-color: #bdc3c7; }
.res-card.copperOre::after { background-color: #d35400; }
.res-card.plank::after { background-color: #e67e22; }
.res-card.brick::after { background-color: #c0392b; }
.res-card.ironPlate::after { background-color: #ecf0f1; }
.res-card.copperPlate::after { background-color: #f39c12; }
.res-card.glass::after { background-color: #a29bfe; }
.res-card.sulfur::after { background-color: #f1c40f; }
.res-card.steel::after { background-color: #4b6584; }
.res-card.concrete::after { background-color: #95a5a6; }
.res-card.gear::after { background-color: #636e72; }
.res-card.circuit::after { background-color: #26de81; }
.res-card.advCircuit::after { background-color: #eb4d4b; }
.res-card.processor::after { background-color: #0984e3; }
.res-card.battery::after { background-color: #fed330; }
.res-card.oil::after { background-color: #2d3436; }
.res-card.titaniumOre::after { background-color: #00cec9; }
.res-card.titaniumPlate::after { background-color: #81ecec; }
.res-card.uraniumOre::after { background-color: #badc58; }
.res-card.fuelCell::after { background-color: #6ab04c; }
.res-card.optics::after { background-color: #7ed6df; }
.res-card.nanobots::after { background-color: #686de0; }
.res-card.aiCore::after { background-color: #a29bfe; }
.res-card.rocketFuel::after { background-color: #ff793f; }
.res-card.advAlloy::after { background-color: #485460; }
.res-card.warpCore::after { background-color: #be2edd; }

/* =================================================================
   5. 건물 및 연구소 그리드 (Building & Research)
   ================================================================= */
#building-list, #research-list-container { width: 100%; display: block; }

.sub-build-grid {
    display: grid !important;
    grid-template-columns: repeat(4, 1fr) !important; /* PC 4열 고정 */
    gap: 12px; width: 100%; margin-bottom: 30px;
}

/* 개별 버튼 스타일 (shop-item) */
.shop-item, .btn-large {
    position: relative; width: 100%; height: 90px;
    background-color: var(--bg-button); border: 1px solid #444;
    border-radius: 6px; cursor: pointer; transition: 0.1s; overflow: hidden;
}
.shop-item:hover, .btn-large:hover { background-color: var(--bg-button-hover); transform: translateY(-2px); }
.shop-item.disabled, .btn-large.disabled { opacity: 0.5; background-color: var(--bg-button-disabled); cursor: not-allowed; }

/* 버튼 내부 텍스트 배치 */
.si-name { position: absolute; top: 12px; left: 14px; right: 70px; font-weight: bold; color: #fff; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.si-level { position: absolute; top: 12px; right: 14px; color: #ffd700; }
.si-desc { position: absolute; bottom: 12px; left: 14px; right: 12px; font-size: 0.75rem; color: #aeb6ce; }
.si-cost { position: absolute; top: 32px; right: 14px; font-size: 0.8rem; color: var(--primary-orange); font-weight: bold; }

/* 수동 작업 버튼 전용 (2열) */
#manual-btn-list { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }

/* 연구소 완료 아이템 */
.research-item.done { background-color: #1a2a1a !important; border-color: #27ae60 !important; cursor: default; opacity: 0.8; }

/* =================================================================
   6. 접기/펴기 기능 (Collapsible)
   ================================================================= */
.res-category-title, .build-category-title, .research-section-title {
    cursor: pointer; display: flex !important; justify-content: space-between; align-items: center;
    padding: 8px 10px; border-radius: 4px; user-select: none; margin-bottom: 5px;
}
.res-category-title:hover, .build-category-title:hover, .research-section-title:hover { background: rgba(255, 255, 255, 0.05); }

/* 화살표 회전 */
.toggle-arrow { display: inline-block; transition: transform 0.3s; font-size: 0.7rem; color: #556; }
.collapsed .toggle-arrow { transform: rotate(-90deg); }

/* 접혔을 때 숨김 (최우선순위) */
.collapsed-content { display: none !important; }

/* =================================================================
   7. 전력망 및 시스템 로그 (Systems)
   ================================================================= */
/* 전력 바 애니메이션 */
@keyframes blink-red { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
.power-low { animation: blink-red 0.8s infinite; box-shadow: 0 0 10px #e74c3c; }

/* 토글 스위치 디자인 */
.switch { position: relative; display: inline-block; width: 40px; height: 20px; vertical-align: middle; }
.switch input { opacity: 0; width: 0; height: 0; }
.slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #95a5a6; transition: .4s; border-radius: 20px; }
.slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; }
input:checked + .slider { background-color: #2ecc71; }
input:checked + .slider:before { transform: translateX(20px); }

/* 전력 테이블 스크롤 */
#power-breakdown-container { max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); }

/* 하단 시스템 로그 */
.system-log-area { height: 150px; background-color: #0b0b10; border-top: 2px solid #000; display: flex; flex-direction: column; }
.log-content { flex: 1; overflow-y: auto; padding: 10px; font-family: 'Consolas', monospace; font-size: 0.85rem; }
.log-entry { display: flex; gap: 10px; margin-bottom: 3px; }
.log-time { color: #556; min-width: 65px; }
.log-highlight { color: var(--accent-green); }

/* =================================================================
   8. 반응형 레이아웃 (Media Queries)
   ================================================================= */
/* 노트북/작은 모니터 */
@media (max-width: 1200px) {
    .action-grid { grid-template-columns: 1fr; }
    .sub-build-grid { grid-template-columns: repeat(2, 1fr) !important; }
}

/* 휴대폰/태블릿 */
@media (max-width: 768px) {
    body { flex-direction: column; overflow-y: auto; }
    .sidebar { width: 100%; height: auto; position: sticky; top: 0; z-index: 1000; border-right: none; border-bottom: 1px solid #000; }
    .logo-area { display: flex; align-items: center; justify-content: center; gap: 10px; padding: 10px; }
    .logo-area small, .nav-category { display: none; }
    .nav-menu { display: flex; overflow-x: auto; white-space: nowrap; }
    .nav-item { flex: 1; justify-content: center; border-left: none; border-bottom: 3px solid transparent; }
    .nav-item.active { border-left: none; border-bottom: 3px solid var(--primary-orange); }

    .sub-res-grid { grid-template-columns: repeat(2, 1fr); }
    .sub-build-grid { grid-template-columns: 1fr !important; }
    #manual-btn-list { grid-template-columns: 1fr; }
    
    header { height: auto; flex-direction: column; padding: 10px; }
    .info-panel { flex-direction: column; text-align: center; gap: 10px; }
}

.hidden { display: none !important; }